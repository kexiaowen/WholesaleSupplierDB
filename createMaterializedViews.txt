-- T1
CREATE MATERIALIZED VIEW Warehouse_T1
AS SELECT W_ID, W_TAX
FROM Warehouse
PRIMARY KEY (W_ID);

CREATE MATERIALIZED VIEW District_T1
AS SELECT D_W_ID, D_ID, D_NEXT_O_ID, D_TAX
FROM District
PRIMARY KEY((D_W_ID, D_ID));

CREATE MATERIALIZED VIEW Customer_T1
AS SELECT C_W_ID, C_D_ID, C_ID, C_LAST, C_CREDIT, C_DISCOUNT
FROM Customer
PRIMARY KEY((C_W_ID, C_D_ID, C_ID));

CREATE MATERIALIZED VIEW Item_T1
AS SELECT I_ID, I_NAME, I_PRICE
FROM Item
PRIMARY KEY(I_ID);

CREATE MATERIALIZED VIEW Stock_T1
AS SELECT *
FROM Stock
PRIMARY KEY((S_W_ID, S_I_ID));

-- T2
CREATE MATERIALIZED VIEW Warehouse_T2_Update
AS SELECT W_ID, W_YTD
FROM Warehouse
PRIMARY KEY (W_ID);

CREATE MATERIALIZED VIEW Warehouse_T2_Print
AS SELECT W_ID, W_STREET_1, W_STREET_2, W_CITY, W_STATE, W_ZIP
FROM Warehouse
PRIMARY KEY(W_ID);

CREATE MATERIALIZED VIEW District_T2_Update
AS SELECT D_W_ID, D_ID, D_YTD
FROM District
PRIMARY KEY((D_W_ID, D_ID));

CREATE MATERIALIZED VIEW District_T2_Print
AS SELECT D_W_ID, D_ID, D_STREET_1, D_STREET_2, D_CITY, D_STATE, D_ZIP
FROM District
PRIMARY KEY((D_W_ID, D_ID));

CREATE MATERIALIZED VIEW Customer_T2_Update
AS SELECT C_W_ID, C_D_ID, C_ID, C_YTD
FROM Customer
PRIMARY KEY ((C_W_ID, C_D_ID, C_ID));

CREATE MATERIALIZED VIEW Customer_T2_Print
AS SELECT C_W_ID, C_D_ID, C_ID, C_W_ID, C_D_ID, C_ID, 
    C_FIRST, C_MIDDLE, C_LAST,
    C_STREET 1, C_STREET 2, C_CITY, C_STATE, C_ZIP,
    C_PHONE, C_SINCE, C_CREDIT,
    C_CREDIT LIM, C_DISCOUNT, C_BALANCE
FROM Customer
PRIMARY KEY ((C_W_ID, C_D_ID, C_ID));
